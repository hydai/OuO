{% extends 'base.html' %} {% block title_block%}
<title>Graph | OuO</title>
{% endblock %} {% block body_block %}
<!-- Wrap the rest of the page in another container to center all the content. -->
<script>
function isJSONValid(jsonString) {
    try {
        JSON.parse(jsonString);
    } catch (e) {
        return false;
    }
    return true;
}

function getJSONColumn(jsonString) {
    try {
        return Object.keys(JSON.parse(jsonString)[0]);
    } catch (e) {
        return []
    }
}
$(function(){
  $('#id_data_src').keyup(function(){
    $("select option").remove();
    console.log(this.value);
    json_str = this.value;
    if (isJSONValid(json_str)) {
      col = getJSONColumn(json_str);
      if (col.length) {
        console.log(col);
        for(var i = 0; i < col.length; i++) {
          $("select").append($("<option></option>").attr("value", col[i]).text(col[i]));
        }
      }
    }
  })
})
</script>
<div class="fluid-container" style="background: url(https://s3-ap-northeast-1.amazonaws.com/hackntu/picture/bg-gray.png) repeat; background-size: contain;">
  <br>
  <br>
  <br>
  <br>
  <br>
  <div class="container">
    <form class="form-horizontal" action="" method="post">
      {% csrf_token %}

      {{ form }}

      {% for field in fields %}
      <label for="{{ field.fname }}">{{ field.fname }}:</label>
      <select id="{{ field.fname }}" name="{{ field.fname }}">
      </select>
      {% endfor %}
      <button type="submit" name="userlevel_form" class="btn btn-primary">Submit</button>
    </form>
  </div>
</div>
<!-- /.container -->
<hr> {% endblock %}
